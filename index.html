<!doctype html>
<html lang="en">

<head>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129602100-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-129602100-1');
    </script>

	<meta charset="UTF-8">
	<link href="https://gmpg.org/xfn/11" rel="profile">

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Shadows+Into+Light&display=swap" rel="stylesheet">
  
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	
	<link rel="stylesheet" type="text/css" href="css/style.css?v=20201115" crossorigin="anonymous">
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/riot/3.13.2/riot+compiler.min.js"></script>

	<title>
		EJ's Word Generator - v0.1
	</title>

<script
  src="https://code.jquery.com/jquery-2.2.4.min.js"
  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  crossorigin="anonymous"></script>

<script type="riot/tag">
  <moo class="moo">
  	<div>
    	<h1>Moo</h1>
    </div>
  </moo>
</script>

<script type="riot/tag">
  <web-app>
  	<style>
        .web-app a {
            color: #00f;
        }

        .web-app h1 {
            color: #999;
        }

        .web-app .wordoftheday {
            font-size: 10vw;
            color: #333;
        }

        .web-app pre {
            max-height: 40vh;
            color: #999;
            border: 1px solid #ddd;
        }


        .web-app .word-list {
            width: 100%;
        }

        .web-app .word-list td.word {
            text-align: left;
        }

        .web-app .word-list td.date {
            font-size: 0.5em;
            text-align: right;
        }

        .web-app .words-of-the-past {
            color: #bbb;
        }

        .web-app .words-of-the-future {
            color: #999;
        }


        .web-app .words-of-the-future .word{
            font-size: 2vw;
        }

        .web-app .word-of-today .word {
            font-weight: bolder;
            font-size: 10vw;
        }

    </style>
  	<div class="web-app">
        <div class="row">
            <div class="col text-center">
                <h1>EJ's Word Generator</h1>
            </div>
        </div>
        
        <div class="row justify-content-center">
            <div class="col-12">

        <table class="word-list">
            <tr each={ wordsInTheFuture } class="words-of-the-future">
                <td class="date">{ timeStr  }</td>
                <td class="word" title={ timeStr }>{ word }</td>
            </tr>

            <tr each={ wordOfTheDay } class="word-of-today">
                <td class="date">{ timeStr  }</td>
                <td class="word" title={ timeStr }>{ word }</td>
            </tr>

            <tr each={ wordsInThePast } class="words-of-the-past">
                <td class="date">{ timeStr  }</td>
                <td class="word" title={ timeStr }>{ word }</td>
            </tr>
        </table>

            </div>
        </div>

    </div>

    let tag = this
    const TODAY = new Date()

    tag.word = ""
    tag.updated = ""
    tag.wordsArchive = ""

    /*
    $.getJSON("./data/write10-word-of-the-day.json", (data) => {
        tag.update({
            word: data.word,
            updated: data.timestamp
        })
    })
    */

    $.get("./data/write10-words-archive.tsv", (data) => {
        if( data ) {
            let wordsArrTmp = data.split("\n")

            let wordsArr = wordsArrTmp.map( wordTimeStr => {
                return {
                    word: wordTimeStr.split("\t")[0],
                    timeStr: wordTimeStr.split("\t")[1]
                }
            })

            if(wordsArr && wordsArr.length) {
                tag.update({
                    wordsInTheFuture: wordsArr.filter( word => {
                        let d = new Date(word.timeStr)
                        let year = d.getFullYear()
                        let month = d.getMonth()
                        let day = d.getDate()

                        return TODAY.getFullYear() <= year && TODAY.getMonth() <= month && TODAY.getDate() < day                   
                    }).reverse(),

                    wordOfTheDay: wordsArr.filter( word => {
                        let d = new Date(word.timeStr)
                        let year = d.getFullYear()
                        let month = d.getMonth()
                        let day = d.getDate()

                        return TODAY.getFullYear() == year && TODAY.getMonth() == month && TODAY.getDate() == day
                    }),

                    wordsInThePast: wordsArr.filter( word => {
                        let d = new Date(word.timeStr)
                        let year = d.getFullYear()
                        let month = d.getMonth()
                        let day = d.getDate()

                        return TODAY.getFullYear() >= year && TODAY.getMonth() >= month && TODAY.getDate() > day                   
                    }).reverse()
                })


                console.log(tag.wordsInTheFuture)
                console.log(tag.wordOfTheDay)
                console.log(tag.wordsInThePast)
            }
        }
    })
    
  </web-app>
</script>

</head>

<body>

	<div class="container">
		<web-app />
	</div>

<script>
	document.addEventListener("DOMContentLoaded", function(){
		window.getUrlVars = () => {
		    let vars = {}
	        let parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, (m,key,value) => vars[key] = value)
			return vars
		}
        
		riot.mount("*")
	});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.min.js" integrity="sha512-8qmis31OQi6hIRgvkht0s6mCOittjMa9GMqtK9hes5iEQBQE/Ca6yGE5FsW36vyipGoWQswBj/QBm2JR086Rkw==" crossorigin="anonymous"></script>

</body>
